<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coffee Shop POS - Cashier</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="/static/cashier_pos.css" rel="stylesheet" />
  </head>
  <body>
    <div class="pos-container">
      <!-- Header -->
      <div class="pos-header text-white p-3">
        <div class="container-fluid">
          <div class="row align-items-center">
            <div class="col-md-6">
              <h3 class="mb-0">
                <i class="fas fa-coffee me-2"></i>
                QG
              </h3>
            </div>
            <div class="col-md-6 text-end">
              <span class="me-3"
                >Welcome, <strong id="cashier-name">Cashier</strong></span
              >
              <button
                class="btn btn-outline-info me-2"
                onclick="showOrderHistory()"
              >
                <i class="fas fa-history me-1"></i>Order History
              </button>
              <button
                class="btn btn-outline-warning me-2"
                onclick="showPendingOrders()"
              >
                <i class="fas fa-clock me-1"></i>Pending Orders
              </button>
              <button class="btn btn-outline-light" onclick="logout()">
                <i class="fas fa-sign-out-alt me-2"></i>Logout
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="container-fluid">
        <div class="row">
          <!-- Product Selection Area -->
          <div class="col-md-8">
            <!-- Search Box -->
            <div class="search-box">
              <i class="fas fa-search me-2 text-muted"></i>
              <input
                type="text"
                id="product-search"
                placeholder="Search products..."
                onkeyup="searchProducts()"
              />
            </div>

            <!-- Category Tabs -->
            <div class="category-tabs">
              <div class="d-flex flex-wrap">
                <button
                  class="category-tab active"
                  onclick="filterByCategory('all')"
                >
                  All
                </button>
                <!-- Categories will be loaded here -->
              </div>
            </div>

            <!-- Pending Orders Modal -->
            <div
              class="modal fade"
              id="pendingOrdersModal"
              tabindex="-1"
              aria-labelledby="pendingOrdersModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="pendingOrdersModalLabel">
                      <i class="fas fa-clock me-2"></i>Pending Orders
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <div id="pending-orders-list">
                      <!-- Pending orders will be loaded here -->
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      onclick="refreshPendingOrders()"
                    >
                      <i class="fas fa-sync-alt me-1"></i>Refresh
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Order History Modal -->
            <div
              class="modal fade"
              id="orderHistoryModal"
              tabindex="-1"
              aria-labelledby="orderHistoryModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="orderHistoryModalLabel">
                      <i class="fas fa-history me-2"></i>Order History
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <div id="order-history-list">
                      <!-- Order history will be loaded here -->
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      onclick="loadOrderHistoryList()"
                    >
                      <i class="fas fa-sync-alt me-1"></i>Refresh
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Product Grid -->
            <div class="product-grid row" id="product-grid">
              <!-- Products will be loaded here -->
            </div>
          </div>

          <!-- Order Panel -->
          <div class="col-md-4">
            <div class="order-panel">
              <h5 class="mb-3">
                <i class="fas fa-shopping-cart me-2"></i>
                Current Order
              </h5>

              <!-- Customer Info -->
              <div class="customer-info">
                <h6>Customer Information</h6>
                <div class="row mb-2">
                  <div class="col-6">
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="customer-name"
                      placeholder="Customer Name"
                    />
                  </div>
                  <div class="col-6">
                    <input
                      type="tel"
                      class="form-control form-control-sm"
                      id="customer-phone"
                      placeholder="Phone"
                    />
                  </div>
                </div>
              </div>

              <!-- Order Items -->
              <div id="order-items">
                <div class="empty-cart">
                  <i class="fas fa-shopping-cart"></i>
                  <p>No items in cart</p>
                  <small>Click on products to add them to your order</small>
                </div>
              </div>

              <!-- Order Summary -->
              <div
                class="order-summary"
                id="order-summary"
                style="display: none"
              >
                <div class="d-flex justify-content-between mb-2">
                  <span>Subtotal:</span>
                  <span id="subtotal">DZD 0</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                  <span>Tax:</span>
                  <span id="tax">DZD 0</span>
                </div>
                <hr />
                <div class="d-flex justify-content-between">
                  <strong>Total:</strong>
                  <strong class="total-amount" id="total">DZD 0</strong>
                </div>

                <!-- Payment Methods -->
                <div class="payment-methods">
                  <button class="payment-btn" onclick="processPayment('cash')">
                    <i class="fas fa-money-bill-wave me-2"></i>Cash
                  </button>
                  <button
                    class="payment-btn btn-warning"
                    onclick="savePendingOrder()"
                  >
                    <i class="fas fa-save me-2"></i>Save Order
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Details Modal -->
    <div class="modal fade" id="productModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="productModalTitle">Product Details</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="text-center mb-3">
              <img
                id="modalProductImage"
                src=""
                class="product-image"
                alt="Product"
              />
            </div>
            <h6 id="modalProductName"></h6>
            <p id="modalProductDescription"></p>

            <!-- Size Options -->
            <div id="sizeOptions" style="display: none">
              <label class="form-label">Size:</label>
              <div class="size-options" id="sizeButtons">
                <!-- Size buttons will be loaded here -->
              </div>
            </div>

            <!-- Modifiers -->
            <div id="modifierOptions" style="display: none">
              <label class="form-label">Modifiers:</label>
              <div class="product-modifiers" id="modifierList">
                <!-- Modifier options will be loaded here -->
              </div>
            </div>

            <!-- Special Instructions -->
            <div class="mb-3">
              <label class="form-label">Special Instructions:</label>
              <textarea
                class="form-control"
                id="specialInstructions"
                rows="2"
                placeholder="Any special requests?"
              ></textarea>
            </div>

            <!-- Quantity -->
            <div class="mb-3">
              <div
                class="d-flex justify-content-between align-items-center mb-2"
              >
                <label class="form-label mb-0">Quantity:</label>
                <span class="stock-info">
                  <i class="fas fa-box me-1"></i>
                  <span id="modalStock">0</span> in stock
                </span>
              </div>
              <div class="quantity-controls">
                <button
                  class="quantity-btn quantity-btn-large"
                  onclick="decreaseQuantity()"
                >
                  <i class="fas fa-minus"></i>
                </button>
                <span id="modalQuantity" class="quantity-display">1</span>
                <button
                  class="quantity-btn quantity-btn-large"
                  onclick="increaseQuantity()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="addToOrder()"
            >
              Add to Order
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Receipt Container (Hidden on screen, visible on print) -->
    <div id="receipt-container" style="display: none">
      <!-- Receipt content will be generated by JS -->
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/cashier_pos.js"></script>
  </body>
</html>
